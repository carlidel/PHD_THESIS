
\chapter{Mathematical elements}\label{ch:mathematical_elements}

\section{Hamiltonian mechanics}\label{sec:1:hamiltonian}

We start by recalling some of the fundamental concepts of Hamiltonian dynamics. This will also define the core elements of nomenclature and notation that will be used for the entirety of this thesis. This theoretical recall mainly follows Ref.~\cite{Arnold:937549}.

Let $(p_i(t),\,q_i(t))$ be a set of co-ordinates, and let $\ham(p_i,\, q_i,\, t)$ be a function, where $1\le i \le n$, the system is said to be \textit{Hamiltonian} if the following equations hold:
%
\begin{equation} 
	%\begin{split}
		\dot p_i = -\pdv{\ham}{q_i}\,,\qquad 		\dot q_i = \pdv{\ham}{p_i} \, .
%	\end{split}
	\label{hameq}
 \end{equation} 

These equations are referred to as \textit{Hamilton equations} with $\ham$ being the \textit{Hamiltonian} of the system. They are related to the Least Action Principle via the 1-form
%
\begin{equation} \omega = p_i \dd q_i -\ham \dd t \, .  \end{equation}

In fact, the integral of the form on the trajectory $q_0\to q_1$ which is described by the motion of a particle in the time interval $[t_0,\,t_1]$ yields
%
\begin{equation}\int_{q_0=q(t_0)}^{q_1=q(t_1)} \qty(p_i \dd q_i - \ham \dd t) = \int_{t_0}^{t_1} \qty(p_i \dv{q_i}{t} - \ham)\dd t =  \int_{t_0}^{t_1} \mathcal{L} \dd t\,. \end{equation}
%
where $\mathcal{L}=p_i\dot q_i - \ham$ is the Lagrangian, obtained by Legendre transformation of the Hamiltonian. 

\subsection{Canonical transformations}

The main advantage of having an Hamiltonian formulation of a system is the freedom in co-ordinates choice. Differently from a Lagrangian formulation, positions and momenta are independent and can be both exchanged in role or mixed to archive optimal formulations, all while the Hamiltoinan equation maintain its form. Such changes in co-ordinates have however to maintain the fundamental property of the Hamiltonian equation defined in Eq.~\eqref{eq:hamem}, also referred to as \textit{symplectic conditions}.

Let us consider an Hamiltonian $\ham(p,q,t)$, for which we wish to apply a co-ordinate transformation $(p_i,q_i)\to(P_i,Q_i)$. To maintain the Hamiltonian properties, we are then looking for a new function $\mathcal{K}(P,Q,t)$ for which
%
\begin{equation}
    \dot P_i = -\pdv{\mathcal{K}}{Q_i}\,, \qquad \dot Q_i = \pdv{\mathcal{K}}{P_i}\,.
\end{equation}
%
Both Hamiltonian formulations need to fulfil the same Least Action Principle:
%
\begin{equation}
    \dd (p_i \dd q_i- \ham \dd t) = \dd(P_i \dd Q_i - \mathcal{K}\dd t)\,,
\end{equation}
%
which implies that the differential
%
\begin{equation}
    \dd F = p_i\dd q_i - P_i \dd Q_i + (\mathcal{K}-\ham)\dd t\, ,
\end{equation}
%
must be exact. This gives us the Hamiltonian transformation laws
%
\begin{equation} 
	p_i = \pdv{F}{q_i}\,, \qquad P_i = -\pdv{F}{Q_i}\,, \qquad \mathcal{K}=\ham+\pdv{F}{t}\,.
\end{equation}
%
The form of the Hamiltonian needs to be changed only if the transformations are time-dependent. The function $F(q,Q,t)$ is referred to as the \textit{generating function} of the transformation.

In the Hamiltonian formulation, the full freedom in co-ordinate choice is such that event the role of time can be re-assigned to another co-ordinate. We will see in the next chapter how this freedom enables the Courant-Snyder co-ordinate system, used in accelerator physics.

When performing such role of time reassignment, we have that the momentum conjugate to that variable, with a minus sign, becomes the new Hamiltonian function.

As an example, let us assign the role of time to $k-$th space co-ordinate $q_k$. Let us highlight the $k-$th term of the form as $p_k = \tilde p$, $q_k=\tilde q$. From here, we can the formally equivalent form
%
\begin{equation}
    p_i \dd q_i - \ham \dd t = \sum_{i\neq k} p_i \dd q_i + (-\ham)\dd t + (-\tilde p)\dd\tilde q\,,
\end{equation}
%
which highlights the new co-ordinate roles, as now it is possible to express the motion as a function of $\tilde q$, whilst $-\tilde p$ plays the role of the Hamiltonian. In this new form, the equivalent equations of motion become
%
\begin{equation} 
\begin{split}
	&\dv{p_i}{\tilde q} = -\pdv{\tilde p}{q_i}\,, \qquad \dv{q_i}{\tilde q} = \pdv{\tilde p}{p_i} \qquad (i\neq k)\,, \\
	&\dv{\ham}{\tilde q} = -\pdv{\tilde p}{t}\,,  \qquad \dv{t}{\tilde q} = \pdv{\tilde p}{\ham}\,. 
\end{split}
\end{equation}

Finally, the time evolution of an Hamiltonian system is a canonical transformation itself. This property justifies the construction of \textit{symplectic integrators}, i.e.\ algorithms of numerical integration of Hamilton equations that preserve the Hamiltonian structure of the system.


\subsection{Action-angle variables}

We consider an $n$-degree of freedom integrable Hamiltonian system, which will have a $2n-$dimensional phase-space with a symplectic manifold described by the phase variables $(p_i,\,q_i)$, where $n$ integrals of motion $J_i=k_i$ in involution are known.

The Liouville states that, if the set $M_{k}$ of the points for which $J_i=k_i$, is compact, then it is diffeomorphic to the $n-$torus $\mathbb{T}^n$, meaning, it is possible to map all orbits to a precise torus. We also have that some functions $\omega_i$ exist so that we have
\begin{equation}
    \dot{\phi}_i = \omega_i(k_1\,\dots,\,k_n)\,, 
\end{equation}
and we denote these functions as \textit{frequencies}.

This implies that, if we set as Hamiltonian one of the integrals of the motion, for example, $\ham=J_1$, we have that the new equation of motion reads
\begin{equation} 
    \dot I_i = 0\,, \qquad \dot \phi_i = \omega_i(J_1\,\dots,\,J_n) \,,
\end{equation} 
which describe the phase flow relative to the chosen Hamiltonian.

This transformation gives us the new co-ordinates $(I_i,\,\phi_i)$, which might not necessarily be symplectic, as $(p_i,\,q_i)\to(I_i,\,\phi_i)$ may not be canonical.

To be sure of the canonical character of the transformation, one can introduce different functions $I_i = I_i(J_1,\dots,\,J_n)$ which fulfill
%
\begin{equation}
    \dot I_i = 0\,, \qquad \dot \phi_i = \omega_i(I_1\,\dots,\,I_n)\,,
\end{equation} 
%
and keep the change of variables canonical.

These functions $I_i$ can be explicitly written. Let us start with the one-di\-men\-sio\-nal case, where the only integral of motion is the Hamiltonian $\ham$ itself, and its conserved value $h$, and the set $M_k$ reduces to $M_h$.

We then can define a canonical transformation starting from the generating function $S(I,q)$, which yields
%
\begin{equation}
  p=\pdv{S}{q}\,, \qquad \phi=\pdv{S}{I}\,, \qquad \ham\qty(p=\pdv{S}{q},q) = h(I)\,.
  \label{eq:transf1}
  \end{equation} 
%
The invariant torus reduces to the closed curves that are identified just from the value of the energy $h$, and, being $h=h(I)$, by that of $I$. When $I$ is constant, the differential of the generating function $\dd S$ reads
%
\begin{equation} 
    \dd S = \pdv{S}{q}\,\dd q = p\,\dd q\,,
\end{equation} 
%
which impies
%
\begin{equation}
    S = \int p\, \dd q\,,
    \label{eq:S}
\end{equation} 
%
which is, ultimately, the generating function.

The $1-$form $p\,\dd q$ is closed, and therefore locally exact on invariant surfaces. Thus, on a level curve of energy $h(I)$, $M_{h(I)}$, the whole change of $S$ is
%
\begin{equation}
    \Delta S(I) = \oint\displaylimits_{M_{h(I)}} p\, \dd q \,.
\end{equation} 
%
Due to Stokes' theorem, this last integral corresponds to the area inside the curve.  Considering now the second equation of \eqref{eq:transf1}, as we have that
%
\begin{equation} 
    \oint\displaylimits_{M_{h(J)}} \dd\phi = 2\pi\,,  
\end{equation} 
%
the periodicity of $\phi$ on the torus implies
%
\begin{equation} 
    \oint\displaylimits_{M_{h(I)}} \dd\qty(\pdv{S}{I}) = \pdv{\Delta S(I)}{I} = 2\pi\,, 
\end{equation}
%
from which we finally get the expression for the canonical action variable $I$
%
\begin{equation}  
    I = \frac{1}{2\pi}\oint\displaylimits_{M_h} p\,\dd q\,.  
\end{equation} 
%
On the other hand, differentiating (\ref{eq:S}) in $I$ we retrieve, from the definition of $\phi$
%
\begin{equation} 
    \phi = \frac{1}{2\pi} \pdv{I}\int p\,\dd q\, . 
\end{equation}  

The generalization to systems with an arbitrary amount of degrees of freedom is straightforward, if we are working in an $\mathbb{R}^{2n}$ phase space. In fact, we can formulate $\gamma_1,\dots, \gamma_n$ 1\textsc{d} cycles to form a basis on the torus $M_{k_i}$. We will then have that the variation of the angular variable $\phi_i$ on the cycle $\gamma_j$ is equal to $2\pi\delta_{ij}$, where $\delta_{ij}$ is the Kroenecker symbol.

In such scenario, the actions variables $I_i$ then read as
%
\begin{equation}
    I_i(k_1,\dots,k_n) = \frac{1}{2\pi}\int_{\gamma_i} p_j\, \dd q_j\, .  
\end{equation} 
%
It can be shown that these integrals are independent from the choice of the $\gamma_i$.~\cite{Arnold:937549}

\section{Averaging principle for Hamiltonian systems}\label{sec:1:averaging}

Many physical systems can be modeled and described in terms of an ideal integrable Hamiltonian affected by small non-integrable perturbations. A common example is the problem of the motion of planets around the Sun, which can be treated as a perturbation of an ideal motion of non-interacting planets around a fixed attracting center. Another relevant example, as we will see in the next chapter, is how the motion of a particle inside a circular accelerator can be described as the perturbation of an otherwise ideal harmonic oscillator-like betatron motion around a reference orbit.

Understanding how these perturbations may or may not affect the properties of an Hamiltonian system is an open problem, which was called by Poincaré as the \textit{``fundamental problem of dynamics''}. Multiple approaches to this problem have been explored and grouped under the general topic of \textit{perturbation theory}.

If the timescale of the perturbation is far smaller than the timescale of the unperturbed system, a standard approach that is often proposed in perturbation theory is to \textit{average} over time these perturbations, under the core idea that motion can be divided in a global ``drift'' and rapid oscillations. This method is referred to as \textit{averaging principle}. We highlight this specific choice of words, as --- Arnol'd reminds --- it is ``not a theorem, but a physical proposition, that is, a vaguely stated and, strictly speaking, false assertion''. However --- he concludes --- ``Such assertions often happen to be fruitful sources for mathematical theorems''~\cite{Arnold:937549}.

Let us consider a completely integrable Hamiltonian system $\ham_0$ with $n$ degrees of freedom. This defines a foliation of at least some domain of its phase space into invariant tori, which define the following action-angle variables $I=(I_1, \ldots, I_n)$, $\phi=(\phi_1, \ldots, \phi_n)$. We consider angle variables of period $2\pi$.

The Hamiltonian $\ham_0$ depends only on the action variables $\ham_0=\ham_0(I)$. The equations of motion in the unperturbed case have the standard form:
\begin{equation}
    \dot{I}=0\,, \qquad \dot{\phi} = \pdv{\ham_0}{I} = \omega_j(I_1,\dots,I_n) \,.
\end{equation}

Let us now add a small Hamiltonian perturbation to $\ham_0$. We consider a perturbing Hamiltonian $\ham_1(I, \phi, \epsilon)$ of period $2\pi$, with $\epsilon$ being a small parameter which represents the magnitude of the perturbation. The resulting perturbed Hamiltonian reads:
\begin{equation}
    \ham = \ham_0 + \epsilon \ham_1\,.
\end{equation}
%
If $\ham_0$ is integrable, we can write the equations of motion in terms of action-angle variables $(I_j,\phi_j)$:
%
\begin{equation}
    \dot I_j = -\epsilon \pdv{\ham_1}{\phi_j}\,,\qquad
	\dot \phi_j = \omega_j + \epsilon \pdv{\ham_1}{I_j}\, .
\end{equation}
%

The same notation can be used if the perturbation is also periodical in time with frequency $\omega$, as one can extend the phase space to introduce two new degrees of freedom: the angle $\psi=\omega t$ and the conjugated momentum $I_\psi$.

If we apply the concept of the averaging principle to the perturbed Hamiltonian system, we transform the perturbed system into a simpler one, where the fast periodic oscillations induced by $\ham_1$ are averaged out. These oscillations are treated eventually as an extra drift element on the original unperturbed solution. We then define a new averaged Hamiltonian $\av{\ham}$ which reads
%
\begin{equation} 
	\av\ham(I) = \ham_0(I)+\epsilon \av{ \ham_1(\phi_i, I_i, \epsilon=0) }\,,
\end{equation}
%
where we are considering the standard definition of integral average
%
\begin{equation} 
	\av{f} = \frac{1}{(2\pi)^n}\oint_{\mathbb{T}^n}\dd^n\phi\, f(\epsilon=0) \, .
\end{equation}
%
where $\mathbb{T}^n$ is the $n$-dimensional torus.

To be able to apply correctly the averaging principle, it is fundamental that all the frequencies $\omega_j$, and, in case, the perturbation frequency $\omega$, are not in any resonant conditions. Namely, there must be no vector of frequencies $\omega_{1,\ldots,r}\,(r\leq n)$ such that exists a vector $k_j \in \mathbb{Z}^r$ for which $\sum k_j \omega_j \approx 0$.

If this condition holds, it is immediate to observe that the action variables $I_j$, evolves at an order of magnitude $\mathcal{O}(\epsilon)$, while instead the angles $\phi_j$ evolve at $\mathcal{O}(1)$. As $\epsilon \ll 1$, we can classify the action variables as \textit{slow variables} and the angle variables as \textit{fast}.

If instead there are two or more resonant frequencies, it is not possible to perform this kind of averaging, as it would neglect significant effects of the perturbation on the dynamics. This can be seen in a simple example $r=2$, i.e.\ where, in an $n-$dimensional system with $\omega_n$ frequencies, we consider $\omega_1$ and $\omega_2$ to be in resonant condition with resonance numbers $k_1$ and $k_2$. If we consider the following linear symplectic transformation
\begin{equation}
    \theta_1 = k_1 \phi_1 + k_2 \phi_2\,,\qquad \theta_j=\phi_j,\, \text{for}\ 2\leq j \leq n\,,
\end{equation}
which also implies the linear transform of the momenta $I_j$ into $\tilde I_j$ due to the symplectic conditions. We obtain that the new equation of motion for $\theta_1$ is
\begin{equation}
    \dot\theta_1 = k_1\omega_1 + k_2\omega_2 + \epsilon \pdv{\ham_1}{\tilde I_1} \approx \epsilon \pdv{\ham_1}{\tilde I_1} = \mathcal{O}(\epsilon)\,.
\end{equation}
As $\theta_1$ evolves as a slow variable, it does not meet the conditions for being averaged. All the other $n - 1$ angles $\theta_j$, however, does, as they exhibit an evolution $\mathcal{O}(1)$. This canonical transformation can be extended for all cases $r>2$, and the resulting system will be a system with $r - 1$ slow evolving angles and $n - r + 1$ fast angles.  


% qui a quale teorema ti riferisci? Dal momento che la tua tesi utilizza un approccio diffusivo alla dinamica Hamiltoniana io vedrei bene una parte che sul caos e indicatori correlati in modo da inserire l'approccio stocastico, In questo senso i teoremi delle media sarebbero sulle variabili stocastiche angolari non nel caso deterministico

\section{Kolmogorov-Arnold-Moser (KAM) theorem}\label{sec:1:kam}
% Questa parte dovrebbe essere breve e precisa (ovvero i teoremi vanno citati in modo rigoroso). La focalizzerei sulle mappe per le applicazioni agli acceleratori e sulla nascita delle aree debolmente caotiche. La facciamo a quattro mani (ovvero imposta il file tex e poi intervengo io)

As stated in the previous section, the averaging principle is not a mathematically proved theorem to be applied to every physical system. However, for Hamiltonian system, there are rigorous results which offer better insights on the effects of perturbations. One of the most important results is the theorem of Kolmogorov~\cite{} for \textit{non-degenerate} Hamiltonian systems, then extended by Arnold~\cite{} for \textit{isoenergetically non-degenerate} ones, which shows what happens to the non-resonant tori of an unperturbed system $\ham_0$ under a small perturbation $\ham_1$.

Let us consider a perturbed Hamiltonian system in the form of
\begin{equation}
    \ham(I, \phi, \epsilon) = \ham_0(I) + \epsilon\ham_1(I,\phi,\epsilon)\,,
    \label{eq:1:hamperturbed}
\end{equation}
when considering the unperturbed Hamiltonian $\ham_0$, we have that its phase-space will be foliated into invariant tori of constant $I$. The tori that have non-resonant frequencies will have its trajectories filling the toroidal space everywhere densely. Conversely, the tori with resonant frequencies will be foliated into invariant tori of lower dimension.

The unperturbed system $\ham_0$ is classified as \textit{non-degenerate} if its frequencies are functionally independent, namely, if
\begin{equation}
    \det\left(\pdv{\omega}{I}\right) = \det\left(\pdv[2]{\ham_0}{I}\right) \neq 0 \,.
\end{equation}
In such a non-degenerate system, the non-resonant tori form a set in the phase-space of full measure that is densely populated by the orbits. The resonant tori, instead, form a set of measure zero, which however are still densely populated by the orbits. Most importantly, we have that the application
\begin{equation}
    \begin{array}{r}
    F: \mathbb{R}^{n} \longrightarrow \mathbb{R}^n \\
    (I) \longrightarrow(\omega)
    \end{array}
\end{equation}
is a diffeomorphism. This means that the invariant tori are equally well described by the action variables $I$ or by their corresponding frequencies $\omega$.

The unperturbed system $\ham_0$ is classified as \textit{isoenergetically non-degenerate} if the following condition holds:
\begin{equation}
    \operatorname{det}\left(\begin{array}{cc}
    \frac{\partial \omega}{\partial I} & \omega \\
    \omega & 0
    \end{array}\right)=\operatorname{det}\left(\begin{array}{cc}
    \frac{\partial^2 \ham_0}{\partial I^2} & \frac{\partial \ham_0}{\partial I} \\
    \frac{\partial \ham_0}{\partial I} & 0
    \end{array}\right) \neq 0 \,,
\end{equation}
i.e.\ one of the frequencies does not vanish, and the ratio of the other $n-1$ frequencies to it are functionally independent on the value of $\ham_0$. Likewise to the non-degenerate condition, also this condition guarantees the existence on every energy level surface of a set of densely populated invariant tori, which will have full measure for non-resonant frequencies and zero measure for resonant frequencies. The non-degenerate and the isoenergetically non-degenerate conditions are independent.

Now that we have recalled these definitions, we can present the KAM theorem, which proves the integrability of $\ham$ in a closed phase-space subset of large measure:
\begin{theorem}[KAM~\cite{}]
If the unperturbed Hamiltonian system $\ham_0$ is non-degenerate or isoenergetically non-degenerate, then, in the perturbed Hamiltoinan system such as Eq.~\eqref{eq:1:hamperturbed}, most of the non-resonant invariant tori do not disappear but are only slightly deformed. More specifically, there exist positive constants $\epsilon_0,\ a_1,\ a_2,$ and $a_3$, independent of $\epsilon$, such that for any $\epsilon < \epsilon_0$ one can find:
\begin{enumerate}
    \item [(a).] a near to identity canonical transformation
    \begin{equation}
        \begin{array}{r}
        \mathcal{C}_\epsilon: V'\times\mathbb{T}^{n} \longrightarrow V\times\mathbb{T}^n \\
        (I', \phi') \longrightarrow(I, \phi)
        \end{array}
    \end{equation}
    with $V' \subseteq \mathbb{R}^n$ open;
    \item [(b).] a set $V_\epsilon \subseteq V \bigcap V'$;
    \item [(c).] a smooth function $h'_\epsilon(I', \phi)$ defined on $V'\times \mathbb{T}^n$;
\end{enumerate}
which satisfy
\begin{enumerate}
    \item [(i).] $\operatorname{Vol}(V/V_\epsilon) \leq a_1\sqrt{\epsilon}$;
    \item [(ii).] $\norm{I-I'}\leq a_2 \sqrt{\epsilon}$, $\norm{\phi - \phi'} \leq a_3 \sqrt{\epsilon}$;
    \item [(iii).] $\ham_\epsilon \circ \mathcal{C}_\epsilon (I', \phi) = h'_\epsilon (I', \phi)$ whenever $I'\in V_\epsilon$.
\end{enumerate}

\end{theorem}

From this theorem, we can define a set $\mathcal{S}_\epsilon = \mathcal{C}_\epsilon(V_\epsilon \times \mathbb{T}^n) \subseteq V \times \mathbb{T}^n$ of large measure composed of invariant tori. This set is also reffered to as the \textit{KAM set}, which is composed by \textit{KAM tori}. Within this set, due to \textit{(ii)}, we have that any orbit $(I(t), \phi(t))$ having initial condition $(I(0), \phi(0)) \in \mathcal{S}_\epsilon$ satisfies the relation
\begin{equation}
    \norm{I(t) - I(0)} \leq 2 a_2 \sqrt{\epsilon} \,.
\end{equation}
This set of invariant tori $\mathcal{S}_\epsilon$ is constructed as a complement of a neighbourhood of all the resonances. Meaning, if we consider any vector $k\in \mathbb{Z}^n$ defining a resonance order, we have a resulting resonant manifold which reads
\begin{equation}
    \mathcal{R}_k = \left\{I\in V \, \big| \, \sum_i k_i \omega_i(I) = 0\right\} \,
\end{equation}  
and we exclude a neighbourhood of $\mathcal{R}_k$ following a Diophantine law:
\begin{equation}
    \left|\sum_i k_i \omega_i(I)\right| \leq \frac{\gamma_0 \sqrt{\epsilon}}{|k|^\tau} \,,
\end{equation}
where $\gamma_0 > 0$ is a suitable positive constant and $\tau > n-1$. This excluded neighbourhood of resonances is reffered to as \textit{Arnol'd web}~\cite{}.

The proof of the KAM theorem is based on the possibility to define a converging procedure for consistently eliminating the fast phases of $\ham$ in incresasingly high orders in the small parameter. Such procedure has the property of quadratic convergence, as after $m$ successive changes of variables, the phase-dependent discrepancy in the new Hamiltonian is of order $\epsilon^{2^m}$.

At each step, the generating function is constructed on the sum of the Fourier harmonics of $\ham_1$ whose order do not exceed an integer $N$. The integer $N$ is then chosen so that the absolute value of the remainder $R_{1N} = \ham_1 - \ham_{1N}$ of the Fourier series does not exceed $\epsilon$. These progressive steps gradually lead to a superconvergence to the non-resonant KAM set.

The KAM theorem has important consequences for the analysis of stability of perturbed Hamiltonian systems. The most immediate one being the existence of large reagions with absence of evolution for systems with two degrees of freedom:
\begin{theorem}(\cite{})
    In an isoenergetically non-degenerate system with two degrees of freedom, all initial conditions will have their action variables remaining near their initial value.
\end{theorem} 
This theorem has immediate proof, as such a system has a four-dimensional phase space with three-dimensional energy levels which are highly populated by two-dimensional KAM tori. Since a two-dimensional torus has the topological property to divide a three-dimensional energy level, an orbit starting in a gap between two KAM tori will be forever trapped between those tori. Resulting action variable oscillations will not exceed the order of magnitude of $\sqrt{\epsilon}$, following the estimates given by KAM theorem. 

When instead we are considering a system with more than two degrees of freedom, we have that the $n-$dimensional invariant tori do not divide a $(2n-1)$-dimensional energy-level manifold. The tori instead are located in it like points on a plane or lines in a space. Consequently, the gaps between tori, related by different resonance spaces, are all connected with each other. This does not prevent a phase curve originated near a resonance region to eventually evolve far away from its initial action value. 

\section{Nekhoroshev theorem}\label{sec:1:nekhoroshev}
%  Qui come sopra: il th di Nekhoroshev ha molte formulazioni (soprattutto per la questione dell'esponente nella stima ottimale). Io non entrerei nei dettagli ma nella generalità del risultato correlato all'analiticità delle serie perturbative

As stated in the previos section, even though the stability set $\mathcal{S}_\epsilon$ has large relative measure, its complement can be open, dense, and if the number of degrees of freedom is larger than two, also connected, enabling evolution at different energy levels.

Therefore, the possibility for solutions to wandering the complement of $\mathcal{S}_\epsilon$, such as the so called Arnol’d diffusion, can prevent any result of stability over an infinite time.

Because of this, it becomes difficult (if not impossible) to treat the problem of the evolution of a perturbed Hamiltoinan system with the ``classical'' definition of stability, as in, confinement in a region to infinite times. But it is possible to operate with asymptotic estimates, which are limited to very long times\footnote{For example, orders of magnitudes higher than the usual operation time of an accelerator machine.}, such estimates can be formulated as:
\begin{equation}
    |I(t)-I(0)| \leq r(\epsilon)
\end{equation}
which are valid for times $|t| \leq T(\epsilon)$ such that $r \rightarrow 0$ and $T \rightarrow \infty$ in the limit $\epsilon \rightarrow 0$. 

In the case $\ham$ satisfies a technical property called \textit{steepness}\footnote{The notion of steepness was introduced by Nekhoroshev in~\cite{}. The definition we report here is a necessary and sufficient condition for steepness~\cite{}.}, a very important result on the estimate of diffusion scale times holds. An analytic function is said to be \textit{steep} if it has no stationary points and its restriction to any plane of any dimension has only isolated stationary points.

Such result is stated by Nekhoroshev in his celebrated theorem, named after him:
\begin{theorem}[Nekhoroshev's theorem~\cite{}]
    Let us consider a perturbed Hamiltonian system in the form of Eq~\eqref{eq:1:hamperturbed}. If the unperturbed Hamiltonian $\ham_0$ is steep, there exist positive constants $\epsilon_0, a, b, t_0, r$ such that for any $\epsilon<\epsilon_0$, and for any motion $(I(t), \phi(t))$ with $(I(0), \phi(0)) \in V \times \mathbb{T}^n$ it is
    \begin{equation}
        |I(t)-I(0)| \leq r \epsilon^a \,,
    \end{equation}
    for any time t satisfying:
    \begin{equation}
        0 \leq t \leq t_0 \exp \left(\frac{\epsilon_0}{\epsilon}\right)^b \,,  
    \end{equation}
    where the value of the constants $a, b$ depend on the steepness properties of $\ham_0$.
\end{theorem}

A complete overview of the theorem's proof is presented in~\cite{}, the outline of it is that the long-term behaviour of the orbits can be studied removing from $\ham$ only a finite number of harmonics $\epsilon \ham_{1k}(I) e^{i k \cdot \phi}$, precisely those with order $|k|=\sum_{i=1}^n\left|k_i\right|$ up to a given threshold $K$. The harmonics with $|k| \geq K$ can then be estimated to be exponentially small. As a consequence, if one chooses $K$ suitably large, these terms turn out to be very small, and they can determine large deviations of the actions only after long exponential times.

\section{Symplectic maps}

\subsection{Poincaré-Birkhoff theorem}

\subsection{Normal form theory}

\subsection{KAM and Nekhoroshev theorems for symplectic maps}

